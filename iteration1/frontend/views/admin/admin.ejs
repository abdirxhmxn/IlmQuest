<%- include('../partials/adminHeader') -%>

  <link rel="stylesheet" href="/css/pages/admin-dashboard.css">

  <main class="admin-page">
    <div class="page-heading">
      <h1>Admin Dashboard</h1>
      <p>Overview of your community, classes, and teachers.</p>
    </div>

    <section class="stats">
      <div class="stat-card">
        <span class="stat-label">Total Students</span>
        <span class="stat-value">
          <%= students.length %>
        </span>
        <a class="stat-link" href="/admin/users">Manage Students</a>
      </div>
      <div class="stat-card">
        <span class="stat-label">Total Classes</span>
        <span class="stat-value">
          <%= classes.length %>
        </span>
        <a class="stat-link" href="/admin/classes">Manage Classes</a>
      </div>
      <div class="stat-card">
        <span class="stat-label">Total Teachers</span>
        <span class="stat-value">
          <%= teachers.length %>
        </span>
        <a class="stat-link" href="/admin/users">Manage Teachers</a>
      </div>
    </section>

    <section class="panel">
      <div class="panel-header">
        <div>
          <h2 class="directory-title">Directory</h2>
          <p class="directory-subtitle">Switch between students, teachers, and
            classes.</p>
        </div>
        <div class="tabs">
          <button class="tab-btn active" data-target="students-table">Students</button>
          <button class="tab-btn" data-target="classes-table">Classes</button>
          <button class="tab-btn" data-target="teachers-table">Teachers</button>
        </div>
      </div>

      <div class="table-wrap">
        <table id="students-table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Role</th>
              <th>Grade Level</th>
            </tr>
          </thead>
          <tbody>
            <% students.forEach(student=> { %>
              <tr>
                <td>
                  <%= student.firstName %>  <%= student.lastName %>
                </td>
                <td>
                  <%= student.email %>
                </td>
                <td class="caps-cell">
                  <%= student.role %>
                </td>
                <td class="caps-cell">
                  <%= student.studentInfo.gradeLevel || 'NA' %>
                </td>
              </tr>
              <% }) %>
          </tbody>
        </table>

        <table id="classes-table" class="hidden">
          <thead>
            <tr>
              <th>Class Name</th>
              <th>Class Code</th>
              <th>Teachers</th>
              <th>Students</th>
            </tr>
          </thead>
          <tbody>
            <% classes.forEach(cls=> { %>
              <tr>
                <td>
                  <%= cls.className %>
                </td>
                <td>
                  <%= cls.classCode %>
                </td>
                <td>
                  <%= cls.teachers.length %>
                </td>
                <td>
                  <%= cls.students.length %>
                </td>
              </tr>
              <% }) %>
          </tbody>
        </table>

        <table id="teachers-table" class="hidden">
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Role</th>
            </tr>
          </thead>
          <tbody>
            <% teachers.forEach(teacher=> { %>
              <tr>
                <td>
                  <% if (teacher.gender==="female" ) { %>
                    Ms. <%= teacher.lastName %>
                      <% } else { %>
                        Mr. <%= teacher.lastName %>
                          <% } %>
                </td>
                <td>
                  <%= teacher.email %>
                </td>
                <td>
                  <%= teacher.role %>
                </td>
              </tr>
              <% }) %>
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <script>
    const tabButtons = document.querySelectorAll(".tab-btn");
    const tables = document.querySelectorAll(".table-wrap table");

    tabButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        tabButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");

        tables.forEach(table => {
          table.classList.toggle("hidden", table.id !== btn.dataset.target);
        });
      });
    });
  </script>

  <%- include('../partials/adminFooter') -%>
